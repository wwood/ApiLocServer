# To change this template, choose Tools | Templates
# and open the template in the editor.

$:.unshift File.join(File.dirname(__FILE__),'..','lib')

require 'test/unit'
require 'radar'

class RadarTest < Test::Unit::TestCase
  def setup
    @r = Bio::Radar::Wrapper.new
  end

  def test_none
    res = @r.run('AAAAAGAAGGHA')
    assert_kind_of Bio::Radar::Result, res
    assert_equal 0, res.length
  end

  def test_multiple
    input = 'QAQQIVQPQSPLTVSQSKPGCYDNGKHYQINQQWERTYLGSALVCTCYGGSRGFNCESKPEPEET
CFDKYTGNTYRVGDTYERPKDSMIWDCTCIGAGRGRISCTIANRCHEGGQSYKIGDTWRRPHETG
GYMLECVCLGNGKGEWTCKPIAEKCFDQAAGTSYVVGETWEKPYQGWMMVDCTCLGEGSGRITCTSRNRCNDQDTRTSYRIGDTWSKKDNRGNLLQCICTGNGRGEWKCERHTSLQTTSAGSGSFTDVRTAIYQPQPHPQPPPYGHCVTDSGVVYSVGMQWLKTQGNKQMLCTCLGNGVSCQETAVTQTYGGNSNGEPCVLPFT
YNGKTFYSCTTEGRQDGHLWCSTTSNYEQDQKYSFCTDHTVLVQTRGGNSNGALCHFPFLYNNHNYTDCTSEGRRDNMKWCGTTQNYDADQKFGFCPMAAHEEICTTNEGVMYRIGDQWDKQHDMGHMMRCTCVGNGRGEWTCVAYSQLRDQCIVDGITYNVNDTFHKRHEEGHMLNCTCFGQGRGRWKCDPVDQCQDSETRTF
YQIGDSWEKYLQGVRYQCYCYGRGIGEWACQPLQTYPDTSGPVQVIITETPSQPNSHPIQWSAPESSHISKYILRWKPKNSPDRWKEATIPGHLNSYTIKGLRPGVVYEGQLISVQHYGQREVTRFDFTTTSTSPAVTSNTVTGETTPLSPVVATSESVTEITASSFVVSWVSASDTVSGFRVEYELSEEGDEPQYLDLPSTAT
SVNIPDLLPGRKYTVNVYEISEEGEQNLILSTSQTTAPDAPPDPTVDQVDDTSIVVRWSRPRAPITGYRIVYSPSVEGSSTELNLPETANSVTLSDLQPGVQYNITIYAVEENQESTPVFIQQETTGVPRSDKVPPPRDLQFVEVTDVKITIMWTPPESPVTGYRVDVIPVNLPGEHGQRLPVSRNTFAEVTGLSPGVTYHFKV
FAVNQGRESKPLTAQQATKLDAPTNLQFINETDTTVIVTWTPPRARIVGYRLTVGLTRGGQPKQYNVGPAASQYPLRNLQPGSEYAVSLVAVKGNQQSPRVTGVFTTLQPLGSIPHYNTEVTETTIVITWTPAPRIGFKLGVRPSQGGEAPREVTSESGSIVVSGLTPGVEYVYTISVLRDGQERDAPIVKKVVTPLSPPTNLH
LEANPDTGVLTVSWERSTTPDITGYRITTTPTNGQQGYSLEEVVHADQSSCTFENLSPGLEYNVSVYTVKDDKESVPISDTIIPAVPPPTDLRFTNVGPDTMRVTWAPPSSIELTNLLVRYSPVKNEEDVAELSISPSDNAVVLTNLLPGTEYLVSVSSVYEQHESIPLRGRQKTALDSPSGIDFSDITANSFTVHWIAPRATI
TGYRIRHHPENMGGRPREDRVPPSRNSITLTNLNPGTEYVVSIVALNSKEESLPLVGQQSTVSDVPRDLEVIAATPTSLLISWDAPAVTVRYYRITYGETGGSSPVQEFTVPGSKSTATISGLKPGVDYTITVYAVTGRGDSPASSKPVSINYRTEIDKPSQMQVTDVQDNSISVRWLPSSSPVTGYRVTTAPKNGPGPSKTKT
VGPDQTEMTIEGLQPTVEYVVSVYAQNQNGESQPLVQTAVTTIPAPTNLKFTQVTPTSLTAQWTAPNVQLTGYRVRVTPKEKTGPMKEINLAPDSSSVVVSGLMVATKYEVSVYALKDTLTSRPAQGVVTTLENVSPPRRARVTDATETTITISWRTKTETITGFQVDAIPANGQTPIQRTIRPDVRSYTITGLQPGTDYKIHL
YTLNDNARSSPVVIDASTAIDAPSNLRFLATTPNSLLVSWQPPRARITGYIIKYEKPGSPPREVVPRPRPGVTEATITGLEPGTEYTIQVIALKNNQKSEPLIGRKKTDELPQLVTLPHPNLHGPEILDVPSTVQKTPFITNPGYDTGNGIQLPGTSGQQPSLGQQMIFEEHGFRRTTPPTTATPVRHRPRPYPPNVNEEIQIG
HVPRGDVDHHLYPHVVGLNPNASTGQEALSQTTISWTPFQESSEYIISCHPVGIDEEPLQFRVPGTSASATLTGLTRGATYNIIVEAVKDQQRQKVREEVVTVGNSVDQGLSQPTDDSCFDPYTVSHYAIGEEWERLSDSGFKLSCQCLGFGSGHFRCDSSKWCHDNGVNYKIGEKWDRQGENGQMMSCTCLGNGKGEFKCDPH
EATCYDDGKTYHVGEQWQKEYLGAICSCTCFGGQRGWRCDNCRRPGAEPGNEGSTAHSYNQYSQRYHQRTNTNVNCPIECFMPLDVQADREDSRE'
    res = @r.run(input)
    assert_kind_of Bio::Radar::Result, res
    assert_equal 2, res.length
  end
end
